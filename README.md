# WinRPC

WinRPC is a simple C++ example demonstrating how to implement a Remote Procedure Call (RPC) using Windows RPC mechanisms. The repository consists of two components:

- **Server**: A Windows RPC server that listens for RPC requests and provides a simple `Add` function.
- **Client**: A client that connects to the server and invokes the `Add` function to perform an addition.

## Features

- **RPC Server**: Listens for incoming RPC calls and provides an implementation of an `Add` function.
- **RPC Client**: Connects to the server and calls the `Add` function, passing two integers.
- **ncalrpc Protocol**: The communication between the client and server happens locally using Windows' `ncalrpc` protocol.

## Prerequisites

To run this example, you need:
- **Windows OS** (since it relies on Windows-specific RPC libraries)
- **Microsoft Visual Studio** or a C++ compiler that supports Windows APIs
- **MIDL (Microsoft Interface Definition Language)** compiler to generate RPC stubs

## Project Structure

WinRPC/
├── Server/
│   ├── main.cpp              # Server implementation using RPC
│   └── calculator_h.h        # Interface header generated by MIDL
├── Client/
│   ├── main.cpp              # Client implementation using RPC
│   └── calculator_h.h        # Same interface header used by the client
├── calculator.idl            # MIDL Interface Definition Language file
└── README.md                 # Project documentation

## Compile the Server

Open the Server/main.cpp file in Visual Studio and build the project. The server will listen for incoming RPC requests and provide the Add function.

## Compile the Client

### Open the Client/main.cpp file in Visual Studio and build the project. The client will connect to the server, invoke the Add function, and display the result.
## How It Works
1. Server-Side

### The server uses RpcServerUseProtseqEp to bind to the ncalrpc protocol sequence and listens for incoming requests using RpcServerListen. When a request comes in, it calls the Add function, which simply adds two integers and returns the result.
## 2. Client-Side

### The client creates a binding string using RpcStringBindingCompose, connects to the server using RpcBindingFromStringBinding, and invokes the Add function with two integers.
## 3. Communication
```notepad
    Protocol: ncalrpc (local communication)
    Function: Add(handle_t handle, int a, int b) is the exposed RPC function that performs addition.
```

## Example Output

```powershell
Server:
  [+] Server PID is: 1234
  [+] Server is running...
Client:
  [+] Result is: 8
```
## Notes
  The project demonstrates local RPC communication using ncalrpc.
  It’s a basic example designed for learning and testing Windows RPC.
  Ensure that the Windows RPC services are running if using network communication (though ncalrpc typically works locally).
  The code relies on the rpcrt4.lib library, which is required to compile and link the project.
  If you need to customize the server-client protocol or methods, modify the calculator.idl file and regenerate the stubs with the MIDL compiler.

# License
This project is licensed under the MIT License - see the LICENSE file for details.
